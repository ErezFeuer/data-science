<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science - 12&nbsp; Regularization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tirgul/tirgul_9/multiple_regression.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../tirgul/tirgul_1/tutorial_1.html">Tirgul</a></li><li class="breadcrumb-item"><a href="../../tirgul/tirgul_9/regularized_regression.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Regularization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Introduction to Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ErezFeuer/data-science/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">71253</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Tirgul</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_1/tutorial_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Tutorial 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_2/tirgul_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tutorial 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_3/tirgul_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tutorial 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_4/tirgul_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tutorial 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_5/tirgul_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tutorial 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_6/tirgul_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tutorial 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_7/tirgul_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tutorial 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_6/group_by.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Groupby</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_8/bonferroni.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multiple hypothesis correction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_8/logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_9/multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tirgul/tirgul_9/regularized_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Regularization</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-is-it-important" id="toc-why-is-it-important" class="nav-link active" data-scroll-target="#why-is-it-important"><span class="header-section-number">12.1</span> Why is it important?</a>
  <ul class="collapse">
  <li><a href="#we-will-focus-on-two-methods-of-regularized-regression" id="toc-we-will-focus-on-two-methods-of-regularized-regression" class="nav-link" data-scroll-target="#we-will-focus-on-two-methods-of-regularized-regression"><span class="header-section-number">12.1.1</span> We will focus on two methods of regularized regression</a></li>
  <li><a href="#some-notes-on-usage" id="toc-some-notes-on-usage" class="nav-link" data-scroll-target="#some-notes-on-usage"><span class="header-section-number">12.1.2</span> Some notes on usage</a></li>
  <li><a href="#what-happens-when-we-use-more-and-more-predictors" id="toc-what-happens-when-we-use-more-and-more-predictors" class="nav-link" data-scroll-target="#what-happens-when-we-use-more-and-more-predictors"><span class="header-section-number">12.1.3</span> What happens when we use more and more predictors?</a></li>
  </ul></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">12.2</span> Example</a></li>
  <li><a href="#start-the-regression" id="toc-start-the-regression" class="nav-link" data-scroll-target="#start-the-regression"><span class="header-section-number">12.3</span> Start the regression :)</a>
  <ul class="collapse">
  <li><a href="#super-important-standardize-the-data-before-applying-regularization" id="toc-super-important-standardize-the-data-before-applying-regularization" class="nav-link" data-scroll-target="#super-important-standardize-the-data-before-applying-regularization"><span class="header-section-number">12.3.1</span> Super important!!! standardize the data before applying regularization</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="header-section-number">12.4</span> Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#now-lets-try-ridge-regression" id="toc-now-lets-try-ridge-regression" class="nav-link" data-scroll-target="#now-lets-try-ridge-regression"><span class="header-section-number">12.4.1</span> Now, let’s try Ridge regression</a></li>
  <li><a href="#now-lets-try-lasso" id="toc-now-lets-try-lasso" class="nav-link" data-scroll-target="#now-lets-try-lasso"><span class="header-section-number">12.4.2</span> Now, let’s try Lasso</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Regularization</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="https://github.com/ErezFeuer/data-science/blob/main/tirgul/tirgul_9/regularized_regression.ipynb"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="why-is-it-important" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="why-is-it-important"><span class="header-section-number">12.1</span> Why is it important?</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb1-3"><a href="#cb1-3"></a>Image(<span class="st">'image_1.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<p><img src="regularized_regression_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="in-simple-terms" class="level4" data-number="12.1.0.1">
<h4 data-number="12.1.0.1" class="anchored" data-anchor-id="in-simple-terms"><span class="header-section-number">12.1.0.1</span> In simple terms</h4>
<p>A technique that is used to limit model overfitting by shrinking the coefficient estimates towards zero. Our goal is optimized prediction and not inference.</p>
</section>
<section id="in-more-exact-terms" class="level4" data-number="12.1.0.2">
<h4 data-number="12.1.0.2" class="anchored" data-anchor-id="in-more-exact-terms"><span class="header-section-number">12.1.0.2</span> In more exact terms</h4>
<p>Regularized least squares (RLS) is a family of methods for solving the least-squares problem while using regularization to further constrain the resulting solution.</p>
<p>RLS is used for two main reasons. The first comes up when the number of variables in the linear system exceeds the number of observations. In such settings, the ordinary least-squares problem is ill-posed and is therefore impossible to fit because the associated optimization problem has infinitely many solutions. RLS allows the introduction of further constraints that uniquely determine the solution.</p>
<p>The second reason that RLS is used occurs when the number of variables does not exceed the number of observations, but the learned model suffers from poor generalization. RLS can be used in such cases to improve the generalizability of the model by constraining it at training time. This constraint can either force the solution to be “sparse” in some way or to reflect other prior knowledge about the problem such as information about correlations between features. A Bayesian understanding of this can be reached by showing that RLS methods are often equivalent to priors on the solution to the least-squares problem.</p>
<p>https://en.wikipedia.org/wiki/Regularized_least_squares</p>
<p>https://scikit-learn.org/stable/modules/linear_model.html</p>
</section>
<section id="we-will-focus-on-two-methods-of-regularized-regression" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="we-will-focus-on-two-methods-of-regularized-regression"><span class="header-section-number">12.1.1</span> We will focus on two methods of regularized regression</h3>
<section id="ridge" class="level4" data-number="12.1.1.1">
<h4 data-number="12.1.1.1" class="anchored" data-anchor-id="ridge"><span class="header-section-number">12.1.1.1</span> (1) Ridge</h4>
<ul>
<li>Performs L2 regularization, i.e.&nbsp;adds penalty equivalent to square of the magnitude of coefficients</li>
<li>Minimization objective = LS Obj + α * (sum of square of coefficients)</li>
</ul>
<p>https://en.wikipedia.org/wiki/Ridge_regression</p>
</section>
<section id="lasso" class="level4" data-number="12.1.1.2">
<h4 data-number="12.1.1.2" class="anchored" data-anchor-id="lasso"><span class="header-section-number">12.1.1.2</span> (2) Lasso</h4>
<p>https://en.wikipedia.org/wiki/Lasso_(statistics)</p>
<ul>
<li>Performs L1 regularization, i.e.&nbsp;adds penalty equivalent to absolute value of the magnitude of coefficients</li>
<li>Minimization objective = LS Obj + α * (sum of absolute value of coefficients)</li>
</ul>
</section>
</section>
<section id="some-notes-on-usage" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="some-notes-on-usage"><span class="header-section-number">12.1.2</span> Some notes on usage</h3>
<p>For both ridge and lasso you have to set a so-called “meta-parameter” that defines how aggressive regularization is performed. Meta-parameters are usually chosen by cross-validation. For Ridge regression the meta-parameter is often called “alpha” or “L2”; it simply defines regularization strength. For LASSO the meta-parameter is often called “lambda”, or “L1”. In contrast to Ridge, the LASSO regularization will actually set less-important predictors to 0 and help you with choosing the predictors that can be left out of the model.</p>
</section>
<section id="what-happens-when-we-use-more-and-more-predictors" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="what-happens-when-we-use-more-and-more-predictors"><span class="header-section-number">12.1.3</span> What happens when we use more and more predictors?</h3>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>Image(<span class="st">'image_2.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<p><img src="regularized_regression_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="example" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="example"><span class="header-section-number">12.2</span> Example</h2>
<p>We will use data from the boston house prediction dataset.</p>
<p>In this dataset, each row describes a Boston town or suburb.</p>
<p>There are 506 rows and 13 attributes (features) with a target column (price).</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># import libraries</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Ridge, Lasso</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># # load dataset</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># boston_dataset = datasets.fetch_california_housing()</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># # boston_dataset = datasets.load_diabetes()</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># print(boston_dataset.DESCR)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># import dataset</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="bu">file</span> <span class="op">=</span> <span class="st">"./BostonHousing.csv"</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>data <span class="op">=</span> pd.read_csv(<span class="bu">file</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">crim</th>
<th data-quarto-table-cell-role="th">zn</th>
<th data-quarto-table-cell-role="th">indus</th>
<th data-quarto-table-cell-role="th">chas</th>
<th data-quarto-table-cell-role="th">nox</th>
<th data-quarto-table-cell-role="th">rm</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">dis</th>
<th data-quarto-table-cell-role="th">rad</th>
<th data-quarto-table-cell-role="th">tax</th>
<th data-quarto-table-cell-role="th">ptratio</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">lstat</th>
<th data-quarto-table-cell-role="th">PRICE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.00632</td>
<td>18.0</td>
<td>2.31</td>
<td>0</td>
<td>0.538</td>
<td>6.575</td>
<td>65.2</td>
<td>4.0900</td>
<td>1</td>
<td>296</td>
<td>15.3</td>
<td>396.90</td>
<td>4.98</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.02731</td>
<td>0.0</td>
<td>7.07</td>
<td>0</td>
<td>0.469</td>
<td>6.421</td>
<td>78.9</td>
<td>4.9671</td>
<td>2</td>
<td>242</td>
<td>17.8</td>
<td>396.90</td>
<td>9.14</td>
<td>21.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.02729</td>
<td>0.0</td>
<td>7.07</td>
<td>0</td>
<td>0.469</td>
<td>7.185</td>
<td>61.1</td>
<td>4.9671</td>
<td>2</td>
<td>242</td>
<td>17.8</td>
<td>392.83</td>
<td>4.03</td>
<td>34.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.03237</td>
<td>0.0</td>
<td>2.18</td>
<td>0</td>
<td>0.458</td>
<td>6.998</td>
<td>45.8</td>
<td>6.0622</td>
<td>3</td>
<td>222</td>
<td>18.7</td>
<td>394.63</td>
<td>2.94</td>
<td>33.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.06905</td>
<td>0.0</td>
<td>2.18</td>
<td>0</td>
<td>0.458</td>
<td>7.147</td>
<td>54.2</td>
<td>6.0622</td>
<td>3</td>
<td>222</td>
<td>18.7</td>
<td>396.90</td>
<td>5.33</td>
<td>36.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>data.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>crim       0
zn         0
indus      0
chas       0
nox        0
rm         0
age        0
dis        0
rad        0
tax        0
ptratio    0
b          0
lstat      0
PRICE      0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># take a look at the data</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>sns.pairplot(data, corner <span class="op">=</span> <span class="st">"True"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">18</span>))</span>
<span id="cb8-2"><a href="#cb8-2"></a> </span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="cf">for</span> ii, feature_name <span class="kw">in</span> <span class="bu">enumerate</span>(data.columns[:<span class="op">-</span><span class="dv">1</span>]):</span>
<span id="cb8-4"><a href="#cb8-4"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">4</span>, <span class="dv">4</span>, ii <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>    ax.scatter(data.iloc[:, ii], data.iloc[:,<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb8-6"><a href="#cb8-6"></a>    ax.set_ylabel(<span class="st">'House Price'</span>, size <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>    ax.set_xlabel(feature_name, size <span class="op">=</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="we-can-observe-from-the-above-scatter-plots-that-some-of-the-independent-variables-are-highly-correlated-either-positively-or-negatively-with-the-target-variable.-what-will-happen-to-these-variables-when-we-perform-the-regularization" class="level4" data-number="12.2.0.1">
<h4 data-number="12.2.0.1" class="anchored" data-anchor-id="we-can-observe-from-the-above-scatter-plots-that-some-of-the-independent-variables-are-highly-correlated-either-positively-or-negatively-with-the-target-variable.-what-will-happen-to-these-variables-when-we-perform-the-regularization"><span class="header-section-number">12.2.0.1</span> We can observe from the above scatter plots that some of the independent variables are highly correlated (either positively or negatively) with the target variable. What will happen to these variables when we perform the regularization?</h4>
</section>
</section>
<section id="start-the-regression" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="start-the-regression"><span class="header-section-number">12.3</span> Start the regression :)</h2>
<section id="super-important-standardize-the-data-before-applying-regularization" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="super-important-standardize-the-data-before-applying-regularization"><span class="header-section-number">12.3.1</span> Super important!!! standardize the data before applying regularization</h3>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># standardize the data by computing the z score </span></span>
<span id="cb9-2"><a href="#cb9-2"></a>stand_data <span class="op">=</span> data.<span class="bu">apply</span>(<span class="kw">lambda</span> x:(x<span class="op">-</span>x.mean())<span class="op">/</span>x.std(), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># input</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>X <span class="op">=</span> stand_data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-6"><a href="#cb9-6"></a> </span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#output</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>Y <span class="op">=</span> stand_data.iloc[:, <span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="split-the-data-into-test-and-training-groups" class="level4" data-number="12.3.1.1">
<h4 data-number="12.3.1.1" class="anchored" data-anchor-id="split-the-data-into-test-and-training-groups"><span class="header-section-number">12.3.1.1</span> Split the data into test and training groups</h4>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># split the data into training and testing groups</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>(x_train, </span>
<span id="cb10-4"><a href="#cb10-4"></a> x_test, </span>
<span id="cb10-5"><a href="#cb10-5"></a> y_train, </span>
<span id="cb10-6"><a href="#cb10-6"></a> y_test) <span class="op">=</span> train_test_split(X, Y, test_size <span class="op">=</span> <span class="fl">0.25</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a> </span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="bu">print</span>(<span class="st">"Train data shape of X = </span><span class="sc">% s</span><span class="st"> and Y = </span><span class="sc">% s</span><span class="st"> : "</span><span class="op">%</span>(</span>
<span id="cb10-9"><a href="#cb10-9"></a>    x_train.shape, y_train.shape))</span>
<span id="cb10-10"><a href="#cb10-10"></a> </span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="bu">print</span>(<span class="st">"Test data shape of X = </span><span class="sc">% s</span><span class="st"> and Y = </span><span class="sc">% s</span><span class="st"> : "</span><span class="op">%</span>(</span>
<span id="cb10-12"><a href="#cb10-12"></a>    x_test.shape, y_test.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train data shape of X = (379, 13) and Y = (379,) : 
Test data shape of X = (127, 13) and Y = (127,) : </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="multiple-linear-regression" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="multiple-linear-regression"><span class="header-section-number">12.4</span> Multiple Linear Regression</h2>
<p>First, let’s try multiple linear regression, so that we have a point of comparison</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Apply multiple Linear Regression Model</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>lreg <span class="op">=</span> LinearRegression()</span>
<span id="cb12-3"><a href="#cb12-3"></a>lreg.fit(x_train, y_train)</span>
<span id="cb12-4"><a href="#cb12-4"></a> </span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Generate Prediction on test set</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>lreg_y_pred <span class="op">=</span> lreg.predict(x_test)</span>
<span id="cb12-7"><a href="#cb12-7"></a> </span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># calculating Mean Squared Error (mse)</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>mean_squared_error <span class="op">=</span> np.mean((lreg_y_pred <span class="op">-</span> y_test)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="bu">print</span>(<span class="st">"Mean squared Error on test set : "</span>, mean_squared_error)</span>
<span id="cb12-11"><a href="#cb12-11"></a> </span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co"># Putting together the coefficients and their corresponding variable names</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>lreg_coefficient <span class="op">=</span> pd.DataFrame()</span>
<span id="cb12-14"><a href="#cb12-14"></a>lreg_coefficient[<span class="st">"Columns"</span>] <span class="op">=</span> x_train.columns</span>
<span id="cb12-15"><a href="#cb12-15"></a>lreg_coefficient[<span class="st">'Coefficient Estimate'</span>] <span class="op">=</span> pd.Series(lreg.coef_)</span>
<span id="cb12-16"><a href="#cb12-16"></a>lreg_coefficient[<span class="st">'Type'</span>] <span class="op">=</span> <span class="st">'Linear (MSE: '</span><span class="op">+</span> <span class="bu">str</span>(np.around(mean_squared_error,<span class="dv">2</span>))<span class="op">+</span><span class="st">')'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared Error on test set :  0.16355502227534496</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># plotting the coefficient score</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>sns.barplot(x <span class="op">=</span> lreg_coefficient[<span class="st">"Columns"</span>],</span>
<span id="cb14-5"><a href="#cb14-5"></a>            y <span class="op">=</span> lreg_coefficient[<span class="st">'Coefficient Estimate'</span>],</span>
<span id="cb14-6"><a href="#cb14-6"></a>            hue <span class="op">=</span> <span class="va">None</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>&lt;Axes: xlabel='Columns', ylabel='Coefficient Estimate'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="now-lets-try-ridge-regression" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="now-lets-try-ridge-regression"><span class="header-section-number">12.4.1</span> Now, let’s try Ridge regression</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Train the model</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>alpha <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>ridgeR <span class="op">=</span> Ridge(alpha <span class="op">=</span> alpha)</span>
<span id="cb16-4"><a href="#cb16-4"></a>ridgeR.fit(x_train, y_train)</span>
<span id="cb16-5"><a href="#cb16-5"></a>y_pred <span class="op">=</span> ridgeR.predict(x_test)</span>
<span id="cb16-6"><a href="#cb16-6"></a> </span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># calculate mean square error</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>mean_squared_error_ridge <span class="op">=</span> np.mean((y_pred <span class="op">-</span> y_test)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="bu">print</span>(<span class="st">"Mean squared Error on test set : "</span>, mean_squared_error_ridge)</span>
<span id="cb16-10"><a href="#cb16-10"></a> </span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co"># get ridge coefficient</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>ridge_coefficient <span class="op">=</span> pd.DataFrame()</span>
<span id="cb16-13"><a href="#cb16-13"></a>ridge_coefficient[<span class="st">"Columns"</span>]<span class="op">=</span> x_train.columns</span>
<span id="cb16-14"><a href="#cb16-14"></a>ridge_coefficient[<span class="st">'Coefficient Estimate'</span>] <span class="op">=</span> pd.Series(ridgeR.coef_)</span>
<span id="cb16-15"><a href="#cb16-15"></a>ridge_coefficient[<span class="st">'Type'</span>] <span class="op">=</span> <span class="vs">r'Ridge, $\lambda$ = '</span><span class="op">+</span> <span class="ss">f'</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (MSE: </span><span class="sc">{</span><span class="bu">str</span>(np.around(mean_squared_error,<span class="dv">2</span>))<span class="sc">}</span><span class="ss">)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared Error on test set :  0.16328472190858787</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># merge dataframes</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>frames <span class="op">=</span> [lreg_coefficient,</span>
<span id="cb18-3"><a href="#cb18-3"></a>         ridge_coefficient]</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>all_coefs <span class="op">=</span> pd.concat(frames)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># plotting the coefficient scores</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb18-9"><a href="#cb18-9"></a> </span>
<span id="cb18-10"><a href="#cb18-10"></a>sns.barplot(x <span class="op">=</span> all_coefs[<span class="st">"Columns"</span>],</span>
<span id="cb18-11"><a href="#cb18-11"></a>            y <span class="op">=</span> all_coefs[<span class="st">'Coefficient Estimate'</span>],</span>
<span id="cb18-12"><a href="#cb18-12"></a>            hue <span class="op">=</span> all_coefs[<span class="st">'Type'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;Axes: xlabel='Columns', ylabel='Coefficient Estimate'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Train the model</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>alpha <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>ridgeR <span class="op">=</span> Ridge(alpha <span class="op">=</span> alpha)</span>
<span id="cb20-4"><a href="#cb20-4"></a>ridgeR.fit(x_train, y_train)</span>
<span id="cb20-5"><a href="#cb20-5"></a>y_pred <span class="op">=</span> ridgeR.predict(x_test)</span>
<span id="cb20-6"><a href="#cb20-6"></a> </span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># calculate mean square error</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>mean_squared_error_ridge <span class="op">=</span> np.mean((y_pred <span class="op">-</span> y_test)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a> </span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co"># get ridge coefficient</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>ridge_coefficient_10 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb20-12"><a href="#cb20-12"></a>ridge_coefficient_10[<span class="st">"Columns"</span>]<span class="op">=</span> x_train.columns</span>
<span id="cb20-13"><a href="#cb20-13"></a>ridge_coefficient_10[<span class="st">'Coefficient Estimate'</span>] <span class="op">=</span> pd.Series(ridgeR.coef_)</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co"># r'Ridge, $\lambda$ = '+ f'{alpha} (MSE: {str(np.around(mean_squared_error,2))})'</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>ridge_coefficient_10[<span class="st">'Type'</span>] <span class="op">=</span> <span class="vs">r'Ridge, $\lambda$ = '</span><span class="op">+</span> <span class="ss">f'</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (MSE: </span><span class="sc">{</span><span class="bu">str</span>(np.around(mean_squared_error,<span class="dv">2</span>))<span class="sc">}</span><span class="ss">)'</span></span>
<span id="cb20-16"><a href="#cb20-16"></a></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co"># merge dataframes</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>frames <span class="op">=</span> [lreg_coefficient,</span>
<span id="cb20-19"><a href="#cb20-19"></a>         ridge_coefficient,</span>
<span id="cb20-20"><a href="#cb20-20"></a>         ridge_coefficient_10]</span>
<span id="cb20-21"><a href="#cb20-21"></a></span>
<span id="cb20-22"><a href="#cb20-22"></a>all_coefs <span class="op">=</span> pd.concat(frames)</span>
<span id="cb20-23"><a href="#cb20-23"></a></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co"># plotting the coefficient scores</span></span>
<span id="cb20-25"><a href="#cb20-25"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb20-26"><a href="#cb20-26"></a> </span>
<span id="cb20-27"><a href="#cb20-27"></a>sns.barplot(x <span class="op">=</span> all_coefs[<span class="st">"Columns"</span>],</span>
<span id="cb20-28"><a href="#cb20-28"></a>            y <span class="op">=</span> all_coefs[<span class="st">'Coefficient Estimate'</span>],</span>
<span id="cb20-29"><a href="#cb20-29"></a>            hue <span class="op">=</span> all_coefs[<span class="st">'Type'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;Axes: xlabel='Columns', ylabel='Coefficient Estimate'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="now-lets-try-lasso" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="now-lets-try-lasso"><span class="header-section-number">12.4.2</span> Now, let’s try Lasso</h3>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Train the model</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>alpha <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> alpha)</span>
<span id="cb22-4"><a href="#cb22-4"></a>lasso.fit(x_train, y_train)</span>
<span id="cb22-5"><a href="#cb22-5"></a>y_pred1 <span class="op">=</span> lasso.predict(x_test)</span>
<span id="cb22-6"><a href="#cb22-6"></a> </span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># Calculate Mean Squared Error</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>mean_squared_error <span class="op">=</span> np.mean((y_pred1 <span class="op">-</span> y_test)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co"># Put in dataframe</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>lasso_coeff <span class="op">=</span> pd.DataFrame()</span>
<span id="cb22-12"><a href="#cb22-12"></a>lasso_coeff[<span class="st">"Columns"</span>] <span class="op">=</span> x_train.columns</span>
<span id="cb22-13"><a href="#cb22-13"></a>lasso_coeff[<span class="st">'Coefficient Estimate'</span>] <span class="op">=</span> pd.Series(lasso.coef_)</span>
<span id="cb22-14"><a href="#cb22-14"></a>lasso_coeff[<span class="st">'Type'</span>] <span class="op">=</span> <span class="vs">r'Lasso, $\lambda$ = '</span><span class="op">+</span> <span class="ss">f'</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (MSE: </span><span class="sc">{</span><span class="bu">str</span>(np.around(mean_squared_error,<span class="dv">2</span>))<span class="sc">}</span><span class="ss">)'</span></span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co"># merge dataframes</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>frames <span class="op">=</span> [lreg_coefficient,</span>
<span id="cb22-18"><a href="#cb22-18"></a>         ridge_coefficient,</span>
<span id="cb22-19"><a href="#cb22-19"></a>         ridge_coefficient_10,</span>
<span id="cb22-20"><a href="#cb22-20"></a>         lasso_coeff]</span>
<span id="cb22-21"><a href="#cb22-21"></a></span>
<span id="cb22-22"><a href="#cb22-22"></a>all_coefs <span class="op">=</span> pd.concat(frames)</span>
<span id="cb22-23"><a href="#cb22-23"></a></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co"># plotting the coefficient scores</span></span>
<span id="cb22-25"><a href="#cb22-25"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb22-26"><a href="#cb22-26"></a> </span>
<span id="cb22-27"><a href="#cb22-27"></a>sns.barplot(x <span class="op">=</span> all_coefs[<span class="st">"Columns"</span>],</span>
<span id="cb22-28"><a href="#cb22-28"></a>            y <span class="op">=</span> all_coefs[<span class="st">'Coefficient Estimate'</span>],</span>
<span id="cb22-29"><a href="#cb22-29"></a>            hue <span class="op">=</span> all_coefs[<span class="st">'Type'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;Axes: xlabel='Columns', ylabel='Coefficient Estimate'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Train the model</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> alpha)</span>
<span id="cb24-4"><a href="#cb24-4"></a>lasso.fit(x_train, y_train)</span>
<span id="cb24-5"><a href="#cb24-5"></a>y_pred1 <span class="op">=</span> lasso.predict(x_test)</span>
<span id="cb24-6"><a href="#cb24-6"></a> </span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># Calculate Mean Squared Error</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>mean_squared_error <span class="op">=</span> np.mean((y_pred1 <span class="op">-</span> y_test)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co"># Put in dataframe</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>lasso_coeff_10 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb24-12"><a href="#cb24-12"></a>lasso_coeff_10[<span class="st">"Columns"</span>] <span class="op">=</span> x_train.columns</span>
<span id="cb24-13"><a href="#cb24-13"></a>lasso_coeff_10[<span class="st">'Coefficient Estimate'</span>] <span class="op">=</span> pd.Series(lasso.coef_)</span>
<span id="cb24-14"><a href="#cb24-14"></a>lasso_coeff_10[<span class="st">'Type'</span>] <span class="op">=</span> <span class="vs">r'Lasso, $\lambda$ = '</span><span class="op">+</span> <span class="ss">f'</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (MSE: </span><span class="sc">{</span><span class="bu">str</span>(np.around(mean_squared_error,<span class="dv">2</span>))<span class="sc">}</span><span class="ss">)'</span></span>
<span id="cb24-15"><a href="#cb24-15"></a></span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="co"># merge dataframes</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>frames <span class="op">=</span> [lreg_coefficient,</span>
<span id="cb24-18"><a href="#cb24-18"></a>         ridge_coefficient,</span>
<span id="cb24-19"><a href="#cb24-19"></a>         ridge_coefficient_10,</span>
<span id="cb24-20"><a href="#cb24-20"></a>         lasso_coeff,</span>
<span id="cb24-21"><a href="#cb24-21"></a>         lasso_coeff_10]</span>
<span id="cb24-22"><a href="#cb24-22"></a></span>
<span id="cb24-23"><a href="#cb24-23"></a>all_coefs <span class="op">=</span> pd.concat(frames)</span>
<span id="cb24-24"><a href="#cb24-24"></a></span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co"># plotting the coefficient scores</span></span>
<span id="cb24-26"><a href="#cb24-26"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb24-27"><a href="#cb24-27"></a> </span>
<span id="cb24-28"><a href="#cb24-28"></a>sns.barplot(x <span class="op">=</span> all_coefs[<span class="st">"Columns"</span>],</span>
<span id="cb24-29"><a href="#cb24-29"></a>            y <span class="op">=</span> all_coefs[<span class="st">'Coefficient Estimate'</span>],</span>
<span id="cb24-30"><a href="#cb24-30"></a>            hue <span class="op">=</span> all_coefs[<span class="st">'Type'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;Axes: xlabel='Columns', ylabel='Coefficient Estimate'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regularized_regression_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tirgul/tirgul_9/multiple_regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>